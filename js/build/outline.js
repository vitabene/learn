/* Vitezslav Benes 2015*/

function OutlineItem(a,b){this.text=a,this.parent=b,this.node=this.createNode(a)}function shuffleArray(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var OutlineApp={texts:[],outlineItems:[],textParent:{},tries:0,startTime:0};OutlineApp.fetchOutline=function(a){return""==a?void console.log("no arg passed"):(xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&(OutlineApp.texts=JSON.parse(xmlhttp.responseText),console.log(OutlineApp.texts),OutlineApp.outputOutline())},xmlhttp.open("GET","includes/getoutline.php?id="+a,!0),xmlhttp.send(),void 0)},OutlineApp.check=function(){var a=$("#sortable li");OutlineApp.tries+=1;for(var b=0;b<a.length;b++){var c=OutlineApp.outlineItems[b];if(a[b].innerHTML!==c.text){for(var b=0;b<OutlineApp.outlineItems.length;b++)OutlineApp.outlineItems[b].highlightMistake();setTimeout(function(){$(".mistake").removeClass("mistake")},400);break}c.markCorrect()}return $(".correct").length===a.length&&(OutlineApp.startTime=Math.floor(((new Date).getTime()-OutlineApp.startTime)/1e3),OutlineApp.sendDataTo("results.php","post")),!0},OutlineApp.sendDataTo=function(a,b){var c=document.createElement("form");c.method=b,c.action=a;for(var d=[],e=0;3>e;e++)d[e]=document.createElement("input");d[0].name="num_of_tries",d[0].value=OutlineApp.tries,d[1].name="time",d[1].value=OutlineApp.startTime,d[2].name="set_id",d[2].value=OutlineApp.textParent.data("set"),d[3]=document.createElement("button"),d[3].type="submit";for(var e=d.length-1;e>=0;e--)c.appendChild(d[e]);c.style.display="none",OutlineApp.textParent.append(c),c.submit()},OutlineApp.outputOutline=function(){console.log("outputtin");var a=Object.keys(OutlineApp.texts);console.log(a),console.log(a.length);for(var b=0;b<a.length;b++)console.log(a[b]),OutlineApp.outlineItems[b]=new OutlineItem(OutlineApp.texts[a[b]],a[b]);var c=OutlineApp.outlineItems.slice();shuffleArray(c);for(var b=0;b<c.length;b++){var d=c[b].node;OutlineApp.textParent.append(d)}return!0},OutlineItem.prototype.markCorrect=function(){this.node.className+=" correct"},OutlineItem.prototype.highlightMistake=function(){this.node.className+=" mistake"},OutlineItem.prototype.createNode=function(a){var b=document.createElement("li");return b.innerHTML=a,b.className="cell",b},$(function(){OutlineApp.textParent=$("#sortable"),OutlineApp.textParent.sortable(),OutlineApp.textParent.disableSelection(),OutlineApp.fetchOutline(OutlineApp.textParent.data("set")),$(".check").click(function(){OutlineApp.check()}),OutlineApp.startTime=(new Date).getTime()});
//# sourceMappingURL=outline.js.map